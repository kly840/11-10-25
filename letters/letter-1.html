<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <meta name="robots" content="noindex"/>
  <title>My Letter for You</title>

  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../assets/styles.css"/>

  <style>
    /* logo top-left (gi·ªëng index) */
    .logo-top{ position:absolute; top:18px; left:18px; display:inline-block; }
    .logo-top img{
      height:48px; width:auto; opacity:.95;
      transition:transform .12s ease, filter .12s ease;
      filter: drop-shadow(0 2px 4px rgba(0,0,0,.08));
    }
    .logo-top:hover img{ transform:scale(1.06); filter: drop-shadow(0 6px 14px rgba(0,0,0,.16)); }

    /* trang: ƒë·ªÉ nav d√≠nh ƒë√°y khi n·ªôi dung √≠t */
    .page{ display:flex; flex-direction:column; min-height:75dvh; }

    /* v√πng trung t√¢m g·ªìm 3 c·ªôt: tr√°i (·∫£nh) ‚Äì gi·ªØa (th∆∞) ‚Äì ph·∫£i (·∫£nh) */
    .stage{
      display:grid; grid-template-columns: 160px minmax(300px, 720px) 160px; gap:16px;
      align-items:start; justify-content:center; margin-top:10px;
    }
    @media (max-width:980px){
      .stage{ grid-template-columns: 1fr; }
      .side-left,.side-right{ justify-content:center; }
    }

    /* khung th∆∞ tr·∫Øng ·ªü gi·ªØa */
    .letter-card{ background:var(--paper); color:var(--text); border-radius:18px; padding:20px; box-shadow:var(--shadow); }

    /* c·ªôt ·∫£nh tr√°i/ph·∫£i (·∫£nh n·∫±m ngo√†i card) */
    .side-left, .side-right{ display:flex; flex-direction:column; gap:14px; }
    .side-left img, .side-right img{
      width: clamp(42px, 6vw, 72px); height:auto; object-fit:contain;
      filter: drop-shadow(0 8px 18px rgba(0,0,0,.12));
    }
    /* nh·∫•n ·∫£nh ch√≠nh m·ªôt ch√∫t l·ªõn h∆°n */
    .side-left img.big, .side-right img.big{ width: clamp(62px, 8vw, 100px); }

    /* bottom nav gi·ªëng timeline */
    .spacer{ flex:1 1 auto; }
    .bottom-nav{
      display:flex; gap:12px; flex-wrap:wrap; justify-content:center;
      margin-top:16px; margin-bottom:4px;
    }
  </style>
</head>
<body>
  <!-- 1) Logo -->
  <a href="../index.html" class="logo-top" aria-label="Home">
    <img src="../assets/heart_logo.png" alt="logo">
  </a>

  <header>
    <h1>Your Letter ‚úâÔ∏è</h1>
    <h3>Only opens after the quiz<h3>
  </header>

  <main class="page">
    <!-- Locked state (gi·ªØ nguy√™n) -->
    <div id="locked" class="empty">Locked leu leu üîí - Please solve the <a href="../quiz.html">mini-quiz</a> first.</div>

    <!-- 3 c·ªôt: tr√°i (·∫£nh) ‚Äì gi·ªØa (th∆∞) ‚Äì ph·∫£i (·∫£nh) -->
    <section id="stage" class="stage" style="display:none">
      <!-- 3) ·∫¢nh b√™n tr√°i (ngo√†i khung th∆∞) -->
      <aside class="side-left">
        <img src="../assets/hello_nhan_khungf_stamp.png" alt="" class="big">
        <img src="../assets/mini_heart.png" alt="">
      </aside>

      <!-- Khung th∆∞ tr·∫Øng ·ªü gi·ªØa -->
      <article class="letter-card">
        <img src="../assets/heart_logo.png" alt="" class="img-44" style="opacity:.9">
        <p class="small" style="margin:8px 0 12px">November 11, 2025</p>

        <h3>my letter for u<h3>
        <p>Dear Naan,</p>
        <p>abc xyz ‚Ä¶ (vi·∫øt n·ªôi dung th∆∞ ·ªü ƒë√¢y)</p>

        <p style="margin-top:18px">Yours,<br/>Kylie</p>
      </article>

      <!-- 3) ·∫¢nh b√™n ph·∫£i (ngo√†i khung th∆∞) -->
      <aside class="side-right">
        <img src="../assets/red_heart.png" alt="" class="big">
        <img src="../assets/mini_heart.png" alt="">
      </aside>
    </section>

    <div class="spacer"></div>

    <!-- 4) N√∫t ƒë·ªè, cƒÉn gi·ªØa, s√°t ƒë√°y -->
    <nav class="bottom-nav">
      <a class="btn" href="../index.html">Back Home</a>
      <a class="btn" href="../timeline.html">Memory</a>
      <a class="btn" href="../audio.html">Audio</a>
    </nav>
  </main>

  <!-- 2) Footer -->
  <footer class="small" style="text-align:center">from kly ‚ô°</footer>

  <!-- JS: ki·ªÉm tra token (gi·ªØ nh∆∞ tr∆∞·ªõc) -->
  <script>
    const ANSWERS = { q1:["2:13 am","02:13 am","0213"], q2:["bus stop","at the bus stop"], q3:["pineapple"] };
    const SALT = "kly840";
    function normalize(s){ return (s||"").toString().trim().toLowerCase().replace(/[^\p{L}\p{N}]+/gu,""); }
    async function sha256Hex(str){ const buf=await crypto.subtle.digest("SHA-256", new TextEncoder().encode(str)); return [...new Uint8Array(buf)].map(b=>b.toString(16).padStart(2,"0")).join(""); }
    async function expectedToken(){ const joined=Object.keys(ANSWERS).map(k=>normalize(ANSWERS[k][0])).join("|")+"|"+SALT; return sha256Hex(joined); }

    (async()=>{
      const t = new URLSearchParams(location.search).get("t") || "";
      const ok = t && t === await expectedToken();

      // locked vs stage
      document.getElementById('locked').style.display = ok ? "none" : "block";
      document.getElementById('stage').style.display  = ok ? "grid" : "none";
    })();
  </script>
</body>
</html>